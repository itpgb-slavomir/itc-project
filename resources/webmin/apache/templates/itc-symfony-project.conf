ServerName ${DOM}

# Symfony Environments

ServerAlias www.${DOM}
ServerAlias dev.${DOM}
ServerAlias test.${DOM}
ServerAlias prod.${DOM}

# Maven Environments

ServerAlias maven.${DOM}
ServerAlias snapshot.${DOM}
ServerAlias release.${DOM}

# ITC Environments

ServerAlias project.${DOM}
ServerAlias git.${DOM}
ServerAlias sonar.${DOM}
ServerAlias jenkins.${DOM}
ServerAlias nexus.${DOM}
ServerAlias mysql.${DOM}
ServerAlias pgsql.${DOM}
ServerAlias nginx.${DOM}
ServerAlias portal.${DOM}
ServerAlias repository.${DOM}
ServerAlias ldap.${DOM}
ServerAlias remedy.${DOM}

CustomLog${HOME}/log/virtualmin/${DOM}_access_log combined
DirectoryIndex index.xml index.html index.htm index.php index.php4 index.php5
DocumentRoot ${HOME}/
ErrorLog /var/log/virtualmin/${DOM}_error_log
ProxyRequests On
ProxyPreserveHost On
ProxyVia On
RewriteEngine On
ScriptAlias /cgi-bin/ ${HOME}/cgi-bin/
SSLProxyEngine On
SSLProxyVerify none 
SSLProxyCheckPeerCN off
SSLProxyCheckPeerName off
SSLProxyCheckPeerExpire off
UseCanonicalName Off
VirtualDocumentRoot ${HOME}/%1


RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =${DOM} [NC]
RewriteRule ^(.*)$ https://www.${DOM} [R]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =${DOM} [NC]
RewriteRule ^(.*)$ http://www.${DOM} [R]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =jenkins.${DOM} [NC]
RewriteRule ^(.*)$ https://jenkins.${DOM}:8143$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =jenkins.${DOM} [NC]
RewriteRule ^(.*)$ http://jenkins.${DOM}:8180$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =nexus.${DOM} [NC]
RewriteRule ^(.*)$ http://nexus.${DOM}:8081$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =nexus.${DOM} [NC]
RewriteRule ^(.*)$ http://nexus.${DOM}:8081$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =redmine.${DOM} [NC]
RewriteRule ^(.*)$ http://redmine.${DOM}:3000$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =redmine.${DOM} [NC]
RewriteRule ^(.*)$ http://redmine.${DOM}:3000$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =sonar.${DOM} [NC]
RewriteRule ^(.*)$ http://sonar.${DOM}:9443$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =sonar.${DOM} [NC]
RewriteRule ^(.*)$ http://sonar.${DOM}:9000$1 [P,L]

RewriteCond %{HTTP_HOST} =nexus.${DOM} [NC]
RewriteRule ^(.*)$ http://nexus.${DOM}:8081$1 [P,L]

RewriteCond %{HTTP_HOST} =git.${DOM} [NC]
RewriteRule ^(.*)$ http://tomcat.${DOM}/gitblit-1.6.2$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =tomcat.${DOM} [NC]
RewriteRule ^(.*)$ http://tomcat.${DOM}:8443$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =tomcat.${DOM} [NC]
RewriteRule ^(.*)$ http://tomcat.${DOM}:8080$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =mysql.${DOM} [NC]
RewriteRule ^(.*)$ https://mysql.${DOM}/phpmyadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =mysql.${DOM} [NC]
RewriteRule ^(.*)$ http://mysql.${DOM}/phpmyadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =pgsql.${DOM} [NC]
RewriteRule ^(.*)$ https://pgsql.${DOM}/phppgadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =pgsql.${DOM} [NC]
RewriteRule ^(.*)$ http://pgsql.${DOM}/phppgadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =ldap.${DOM} [NC]
RewriteRule ^(.*)$ https://ldap.${DOM}/phpldapadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =ldap.${DOM} [NC]
RewriteRule ^(.*)$ http://ldap.${DOM}/phpldapadmin$1 [P,L]

RewriteCond %{SERVER_PORT} 443
RewriteCond %{HTTP_HOST} =nginx.${DOM} [NC]
RewriteRule ^(.*)$ https://nginx.${DOM}:8480$1 [P,L]

RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} =nginx.${DOM} [NC]
RewriteRule ^(.*)$ http://nginx.${DOM}:8480$1 [P,L]

RewriteCond %{HTTP_HOST} =maven.${DOM} [NC]
RewriteRule ^(.*)$ http://www.${DOM}/maven [P,L]

RewriteCond %{HTTP_HOST} =project.${DOM} [NC]
RewriteRule ^(.*)$ http://www.${DOM}/project [P,L]

RewriteCond %{HTTP_HOST} =portal.${DOM} [NC]
RewriteRule ^(.*)$ http://portal.${DOM}:8680$1 [P,L]

RewriteCond %{HTTP_HOST} =repository.${DOM} [NC]
RewriteRule ^(.*)$ http://repository.${DOM}:8080/chemistry-opencmis-server-fileshare-0.12.0$1 [P,L]

RewriteCond %{HTTP_HOST} =visual-php-admin.itc.${DOM}
RewriteRule ^(.*)$ http://www.${DOM}/visual-php-admin [P,L]

Alias /maven /usr/share/maven-sites

<Directory "/usr/share/maven-sites">
	Options Indexes MultiViews FollowSymlinks
	AllowOverride None
	Require all granted
</Directory>

Alias /project /usr/share/sk.itcloud.web/www

<Directory "/usr/share/sk.itcloud.web/www">
	Options Indexes MultiViews FollowSymlinks
	AllowOverride None
	Require all granted
</Directory>

<Directory ${HOME}/>
	Options -Indexes +IncludesNOEXEC +SymLinksIfOwnerMatch
	allow from all
	AllowOverride All Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
</Directory>

<Directory ${HOME}/web>
	Options -Indexes +IncludesNOEXEC +SymLinksIfOwnerMatch
	allow from all
	AllowOverride All Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
</Directory>

<Directory ${HOME}/www>
	Options -Indexes +IncludesNOEXEC +SymLinksIfOwnerMatch
	allow from all
	AllowOverride All Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
</Directory>

<Directory ${HOME}/cgi-bin>
	allow from all
	AllowOverride All  Options=ExecCGI,Includes,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
</Directory>